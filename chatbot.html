<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scrub Typhus AI Chatbot</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; display:flex; flex-direction:column; height:100vh; }
header { background:#1E90FF; color:white; padding:20px; text-align:center; font-size:1.5rem; }
#chat-container { flex:1; padding:10px; overflow-y:auto; background:#e9eef3; display:flex; flex-direction:column; }
.message { margin:10px 0; padding:10px 15px; border-radius:12px; max-width:80%; }
.user { background:#1E90FF; color:white; align-self:flex-end; }
.bot { background:white; color:#333; align-self:flex-start; }
footer { display:flex; padding:10px; background:#fff; box-shadow:0 -2px 5px rgba(0,0,0,0.1); }
#user-input { flex:1; padding:10px; font-size:1rem; border-radius:8px; border:1px solid #ccc; outline:none; }
#send-btn { background:#1E90FF; color:white; border:none; padding:10px 15px; margin-left:10px; border-radius:8px; cursor:pointer; font-size:1rem; }
#send-btn:hover { background:#007ACC; }
</style>
</head>
<body>

<header>Scrub Typhus AI Chatbot ü§ñ</header>

<div id="chat-container">
  <div class="bot message">Hello! ‡§Æ‡•à‡§Ç Scrub Typhus ‡§∏‡•á related ‡§Ü‡§™‡§ï‡•á ‡§∏‡§µ‡§æ‡§≤‡•ã‡§Ç ‡§ï‡•á intelligent ‡§ú‡§µ‡§æ‡§¨ ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å‡•§ Ask in Hindi, English, or Hinglish.</div>
</div>

<footer>
  <input type="text" id="user-input" placeholder="Type your question...">
  <button id="send-btn">Send</button>
</footer>

<script>
// Replace with your OpenAI API key
const OPENAI_API_KEY = 'YOUR_OPENAI_API_KEY';

const chatContainer = document.getElementById('chat-container');
const userInput = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');

function addMessage(text, sender){
    const div = document.createElement('div');
    div.className = `message ${sender}`;
    div.textContent = text;
    chatContainer.appendChild(div);
    chatContainer.scrollTop = chatContainer.scrollHeight;
}

async function sendMessage(message){
    addMessage(message, 'user');

    // Store typing indicator in a variable
    const typingDiv = document.createElement('div');
    typingDiv.className = 'message bot';
    typingDiv.textContent = 'Typing...';
    chatContainer.appendChild(typingDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;

    try {
        const response = await fetch('https://api.openai.com/v1/chat/completions', {
            method:'POST',
            headers:{
                'Content-Type':'application/json',
                'Authorization':`Bearer ${OPENAI_API_KEY}`
            },
            body: JSON.stringify({
                model: 'gpt-4o-mini',
                messages: [
                    {role:'system', content:'You are a Scrub Typhus expert. Answer ONLY questions related to Scrub Typhus. If the question is unrelated, reply politely that you can only answer Scrub Typhus questions. You can understand Hindi, English, and Hinglish.'},
                    {role:'user', content:message}
                ],
                temperature:0.7
            })
        });

        const data = await response.json();
        // Remove typing indicator safely
        if(typingDiv) typingDiv.remove();

        const answer = data.choices[0].message.content;
        addMessage(answer,'bot');

    } catch (err){
        if(typingDiv) typingDiv.remove();
        addMessage('Error connecting to AI service.','bot');
        console.error(err);
    }
}

sendBtn.addEventListener('click', ()=>{
    const message = userInput.value.trim();
    if(message){ sendMessage(message); userInput.value=''; }
});

userInput.addEventListener('keypress', e=>{
    if(e.key==='Enter') sendBtn.click();
});
</script>

</body>
</html>
